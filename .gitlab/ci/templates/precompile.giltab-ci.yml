code-generator:
  stage: pre-compile
  image:
    name: namely/protoc-all
    entrypoint: [""]
  script:
    - entrypoint.sh -d ./internal/web/grpc/contracts -l go -o ./internal/web/grpc/contracts --with-gateway --go-source-relative
  artifacts:
    paths:
      - ./internal/web/grpc/contracts
    expire_in: 1 week
#  cache:
#    paths:
#      - ./web/grpc/contracts
  except:
    variables:
      - $UPDATE_ENVIRONMENT_VARIABLE