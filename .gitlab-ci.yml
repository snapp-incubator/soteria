---
image: registry.snapp.tech/docker/golang:1.11.4-alpine3.8

stages:
  - lint
  - pre-compile
  - compile
  - test
  - build
  - release
  - deploy

variables:
  BUILD_PATH: "./"
  OKD_TEH1_CLUSTER_ADDRESS: "okd.private.teh-1.snappcloud.io"
  OKD_TEH2_CLUSTER_ADDRESS: "okd.private.teh-2.snappcloud.io"
  OKD_TEH1_REGISTRY: 'registry.apps.private.teh-1.snappcloud.io'
  OKD_TEH2_REGISTRY: 'registry.apps.private.teh-2.snappcloud.io'
  PROJECT_SERVICE_NAME: 'soteria'
  PROJECT_STAGING: 'realtime-staging'
  PROJECT_PRODUCTION_TEH1: 'realtime-production'
  PROJECT_PRODUCTION_TEH2: 'rtc'
  PROJECT_MOZART: 'mozart'
  PROJECT_VERSION: "${CI_COMMIT_SHA}"


include:
  - local: .gitlab/ci/templates/precompile.gitlab-ci.yml
  - local: .gitlab/ci/templates/compile.gitlab-ci.yml
  - local: .gitlab/ci/templates/test.gitlab-ci.yml
  - local: .gitlab/ci/templates/build.gitlab-ci.yml
  - local: .gitlab/ci/templates/release.gitlab-ci.yml
  - local: .gitlab/ci/templates/chart.gitlab-ci.yml
  - local: .gitlab/ci/templates/deploy.vm.gitlab-ci.yml
  - local: .gitlab/ci/templates/deploy.env.gitlab-ci.yml
  - local: .gitlab/ci/templates/deploy.cloud.gitlab-ci.yml

  - project: dispatching/igniteg/easy-ci
    ref: main
    file: "easy-ci.yml"

  - project: templates/gitlab-templates
    file: sorush.gitlab-ci.yml
